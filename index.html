<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>For Mica</title>
  <style>
    body { 
      margin: 0; 
      background: black; 
      display: flex; 
      justify-content: center; 
      align-items: center;
      height: 100vh;
      flex-direction: column;
    }
    #canvas { z-index: 0; }
  </style>
</head>
<body>

<!-- ðŸŽµ Audio -->
<audio id="music" autoplay loop>
  <source src="blue_yung_kai.mp3" type="audio/mpeg">
  Your browser does not support the audio element.
</audio>

<canvas id="canvas" width="600" height="800"></canvas>

<script>
const canvas = document.getElementById("canvas");
const ctx = canvas.getContext("2d");
const w = canvas.width, h = canvas.height;
const cx = w / 2, cy = h / 2;
let i = 0;

// Heart shape functions
function heartX(t) { return 15 * Math.sin(t) ** 3; }
function heartY(t) { return 12 * Math.cos(t) - 5 * Math.cos(2*t) - 2 * Math.cos(3*t) - Math.cos(4*t); }

// Draw the heart
function draw() {
  if (i >= 900) {
    writeMessage();
    return;
  }
  const t = i / 5;
  const x = heartX(t) * 10; // smaller heart
  const y = heartY(t) * 10;

  ctx.beginPath();
  ctx.moveTo(cx, cy);
  ctx.lineTo(cx + x, cy - y);
  ctx.strokeStyle = "red";
  ctx.lineWidth = 1; // thinner line
  ctx.stroke();

  i++;
  requestAnimationFrame(draw);
}

// Handwriting effect for message
function writeMessage() {
  const messages = ["I love you", "Mica"];
  ctx.fillStyle = "white";
  ctx.font = "26px Arial";
  let y = cy + 150;

  function writeLine(lineIndex) {
    if (lineIndex >= messages.length) return;
    const line = messages[lineIndex];
    let idx = 0;

    function writeChar() {
      if (idx <= line.length) {
        ctx.clearRect(cx - 200, y - 30, 400, 40);
        const text = line.substring(0, idx);
        ctx.fillText(text, cx - ctx.measureText(text).width/2, y);
        idx++;
        setTimeout(writeChar, 150); // speed of handwriting
      } else {
        y += 50; // move down for next line
        setTimeout(() => writeLine(lineIndex + 1), 500);
      }
    }

    writeChar();
  }

  writeLine(0);
}

// Start animation
requestAnimationFrame(draw);

// Ensure music plays on mobile
const music = document.getElementById('music');
document.body.addEventListener('click', () => { music.play(); }, { once: true });
</script>

</body>
</html>